(this["webpackJsonpcontentful-pim-relations-field-app"]=this["webpackJsonpcontentful-pim-relations-field-app"]||[]).push([[0],{20:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var c=n(0),i=n(3),a=n(11),r=(n(18),n(19),n(20),n(8)),o=n(13),s=n(4),l=n(2),d=n(29),u=n(7),j=n(1),b=function(e){var t=e.sdk.field.getValue()||[],n=t?t.map((function(e){return Object(s.a)(Object(s.a)({},e),{},{key:Object(d.a)()})})):[],i=Object(c.useState)(n),a=Object(o.a)(i,2),b=a[0],f=a[1],p=e.sdk.parameters.instance,O=p.referenceKey||"entryId",x=p.quantity||"quantity",h=p.quantityLabel||"Quantity",m=p.typeCode||"typeCode",y=p.typeCodeLabel||"Type Code",v=p.typeLabel||"typeLabel",g=p.typeLabelLabel||"Type Code Label",k=p.defaultLocale||"en-GB",T=p.contentTypes?p.contentTypes.split(/\s*,\s*/g):["topicProduct"];Object(c.useEffect)((function(){e.sdk.window.startAutoResizer()})),Object(c.useEffect)((function(){var t=b.filter((function(e){return!e.name}));if(t.length){console.log(1);var n=t.map((function(e){return e[O]}));e.sdk.space.getEntries({"sys.id[in]":n.join(",")}).then((function(e){var n=t.map((function(t){var n=e.items.filter((function(e){return e.sys.id===t[O]})).pop(),c=Object(s.a)({},t);return c.name=n?n.fields.code[k]:"",c})),c=b.map((function(e){if(!e.name){var t=n.find((function(t){return t.entryId===e.entryId}));t&&(e.name=t.name)}return e}));f(c)}))}}),[b,e.sdk.space,O,k]),Object(c.useEffect)((function(){console.log(2);var t=b.map((function(e){var t={};return t[x]=e[x]||"",t[m]=e[m]||"",t[v]=e[v]||"",t[O]=e[O]||"",t}));e.sdk.field.setValue(t)}),[b,e.sdk.field,O,x,m,v]);var C=function(e,t,n){var c=Object(r.a)(b);c[t][e]=n.target.value,f(c)};return Object(j.jsxs)("section",{children:[Object(j.jsxs)("div",{style:{marginTop:"10px",marginBottom:"10px"},children:[Object(j.jsx)(l.d,{children:"You can sort the rows by dragging them."}),Object(j.jsx)(l.a,{icon:"Delete",buttonType:"negative",size:"small",onClick:function(){b.splice(0,b.length),f([])},children:"Delete All"})]}),Object(j.jsx)("div",{children:Object(j.jsx)(u.a,{onDragEnd:function(e){return function(e){if(e.destination){var t=e.source,n=e.destination;f((function(e){var c=Array.from(e),i=c.splice(t.index,1),a=Object(o.a)(i,1)[0];return c.splice(n.index,0,a),c}))}}(e)},children:Object(j.jsx)(u.c,{droppableId:"rows",children:function(e){return Object(j.jsxs)("div",{ref:e.innerRef,className:"rows",children:[b.map((function(e,t){return Object(j.jsx)(u.b,{draggableId:"".concat(e.id,"-").concat(t),index:t,children:function(n){return Object(j.jsx)("div",Object(s.a)(Object(s.a)(Object(s.a)({},n.draggableProps),n.dragHandleProps),{},{ref:n.innerRef,style:Object(s.a)({userSelect:"none",marginBottom:"10px"},n.draggableProps.style),children:Object(j.jsxs)(l.b,{className:"row",children:[Object(j.jsx)("div",{children:Object(j.jsx)(l.f,{children:t+1})}),Object(j.jsx)("div",{children:Object(j.jsx)(l.i,{value:e[x],labelText:h,placeholder:h,"data-index":t,onChange:function(e){return C(x,t,e)}})}),Object(j.jsx)("div",{children:Object(j.jsx)(l.i,{value:e[m],labelText:y,placeholder:y,"data-index":t,onChange:function(e){return C(m,t,e)}})}),Object(j.jsx)("div",{children:Object(j.jsx)(l.i,{value:e[v],labelText:g,placeholder:g,"data-index":t,onChange:function(e){return C(v,t,e)}})}),Object(j.jsx)("div",{style:{width:"200px"},children:e.name?Object(j.jsx)(l.f,{children:e.name}):Object(j.jsx)(l.h,{svgHeight:"20",children:Object(j.jsx)(l.g,{numberOfLines:"1"})})}),Object(j.jsx)("div",{className:"delete",children:Object(j.jsx)(l.c,{icon:"Delete","data-index":t,onClick:function(){return function(e){var t=b.filter((function(t){return t!==e}));f(t)}(e)}})})]})}),e.key)}},"".concat(e.id,"-").concat(t))})),e.placeholder]})}})})}),Object(j.jsx)("div",{style:{marginTop:"10px",marginBottom:"10px"},children:Object(j.jsx)(l.a,{icon:"Plus",buttonType:"naked",onClick:function(){var t={};T&&(t.contentTypes=T),e.sdk.dialogs.selectMultipleEntries(t).then((function(e){f([].concat(Object(r.a)(b),Object(r.a)(e.map((function(e){var t={key:Object(d.a)()};return t[x]="",t[m]="",t[v]="",t[O]=e.sys.id,t})))))})).catch((function(){}))},children:"Add"})})]})};Object(a.init)((function(e){var t=document.getElementById("root");[{location:a.locations.LOCATION_ENTRY_FIELD,component:Object(j.jsx)(b,{sdk:e})}].forEach((function(n){e.location.is(n.location)&&Object(i.render)(n.component,t)}))}))}},[[27,1,2]]]);
//# sourceMappingURL=main.1642fa39.chunk.js.map